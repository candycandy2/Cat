!function(){function e(e){var t,n,r;if(t=e.getDirection()){for(n=e.getParent();n&&!(r=n.getDirection());)n=n.getParent();t==r&&e.removeAttribute("dir")}}function t(e,t){var n=e.getAttribute("style");n&&t.setAttribute("style",n.replace(/([^;])$/,"$1;")+(t.getAttribute("style")||""))}function n(e,t,n,r){for(var o=CKEDITOR.plugins.list.listToArray(t.root,n),a=[],i=0;i<t.contents.length;i++){var l=t.contents[i];(l=l.getAscendant("li",!0))&&!l.getCustomData("list_item_processed")&&(a.push(l),CKEDITOR.dom.element.setMarker(n,l,"list_item_processed",!0))}var s,E,d=t.root.getDocument();for(i=0;i<a.length;i++){var c=a[i].getCustomData("listarray_index");(s=o[c].parent).is(this.type)||(E=d.createElement(this.type),s.copyAttributes(E,{start:1,type:1}),E.removeStyle("list-style-type"),o[c].parent=E)}var T,u=CKEDITOR.plugins.list.arrayToList(o,n,null,e.config.enterMode),g=u.listNode.getChildCount();for(i=0;i<g&&(T=u.listNode.getChild(i));i++)T.getName()==this.type&&r.push(T);u.listNode.replace(t.root),e.fire("contentDomInvalidated")}function r(e,t,n){var r=t.contents,o=t.root.getDocument(),i=[];if(1==r.length&&r[0].equals(t.root)){var l=o.createElement("div");r[0].moveChildren&&r[0].moveChildren(l),r[0].append(l),r[0]=l}for(var s=t.contents[0].getParent(),E=0;E<r.length;E++)s=s.getCommonAncestor(r[E].getParent());var d,c,T=e.config.useComputedState;for(T=void 0===T||T,E=0;E<r.length;E++)for(var u,g=r[E];u=g.getParent();){if(u.equals(s)){i.push(g),!c&&g.getDirection()&&(c=1);var m=g.getDirection(T);null!==d&&(d=d&&d!=m?null:m);break}g=u}if(!(i.length<1)){var O=i[i.length-1].getNext(),p=o.createElement(this.type);n.push(p);for(var D,C;i.length;)D=i.shift(),C=o.createElement("li"),a(D)?D.appendTo(C):(D.copyAttributes(C),d&&D.getDirection()&&(C.removeStyle("direction"),C.removeAttribute("dir")),D.moveChildren(C),D.remove()),C.appendTo(p);d&&c&&p.setAttribute("dir",d),O?p.insertBefore(O):p.appendTo(s)}}function o(e,t,n){function r(n){!(T=g[n?"getFirst":"getLast"]())||T.is&&T.isBlockBoundary()||!(u=t.root[n?"getPrevious":"getNext"](CKEDITOR.dom.walker.invisible(!0)))||u.is&&u.isBlockBoundary({br:1})||e.document.createElement("br")[n?"insertBefore":"insertAfter"](T)}for(var o=CKEDITOR.plugins.list.listToArray(t.root,n),a=[],i=0;i<t.contents.length;i++){var l=t.contents[i];(l=l.getAscendant("li",!0))&&!l.getCustomData("list_item_processed")&&(a.push(l),CKEDITOR.dom.element.setMarker(n,l,"list_item_processed",!0))}var s=null;for(i=0;i<a.length;i++){var E=a[i].getCustomData("listarray_index");o[E].indent=-1,s=E}for(i=s+1;i<o.length;i++)if(o[i].indent>o[i-1].indent+1){for(var d=o[i-1].indent+1-o[i].indent,c=o[i].indent;o[i]&&o[i].indent>=c;)o[i].indent+=d,i++;i--}var T,u,g=CKEDITOR.plugins.list.arrayToList(o,n,null,e.config.enterMode,t.root.getAttribute("dir")).listNode;r(!0),r(),g.replace(t.root),e.fire("contentDomInvalidated")}function a(e){return e.is("pre")||p.test(e.getName())||"false"==e.getAttribute("contenteditable")}function i(e,t){this.name=e,this.type=t,this.context=t,this.allowedContent=t+" li",this.requiredContent=t}function l(e,t,n,r){for(var o,a;o=e[r?"getLast":"getFirst"](D);)(a=o.getDirection(1))!==t.getDirection(1)&&o.setAttribute("dir",a),o.remove(),n?o[r?"insertBefore":"insertAfter"](n):t.append(o,r)}function s(e){function t(t){var n=e[t?"getPrevious":"getNext"](m);n&&n.type==CKEDITOR.NODE_ELEMENT&&n.is(e.getName())&&(l(e,n,null,!t),e.remove(),e=n)}t(),t(1)}function E(e){return e.type==CKEDITOR.NODE_ELEMENT&&(e.getName()in CKEDITOR.dtd.$block||e.getName()in CKEDITOR.dtd.$listItem)&&CKEDITOR.dtd[e.getName()]["#"]}function d(e,t,n){e.fire("saveSnapshot"),n.enlarge(CKEDITOR.ENLARGE_LIST_ITEM_CONTENTS);var r=n.extractContents();t.trim(!1,!0);var o,a=t.createBookmark(),i=new CKEDITOR.dom.elementPath(t.startContainer),E=i.block,d=i.lastElement.getAscendant("li",1)||E,T=new CKEDITOR.dom.elementPath(n.startContainer),u=T.contains(CKEDITOR.dtd.$listItem),g=T.contains(CKEDITOR.dtd.$list);if(E){var p=E.getBogus();p&&p.remove()}else g&&(o=g.getPrevious(m))&&O(o)&&o.remove();(o=r.getLast())&&o.type==CKEDITOR.NODE_ELEMENT&&o.is("br")&&o.remove();var D=t.startContainer.getChild(t.startOffset);if(D?r.insertBefore(D):t.startContainer.append(r),u){var C=c(u);C&&(d.contains(u)?(l(C,u.getParent(),u),C.remove()):d.append(C))}for(var I,R;n.checkStartOfBlock()&&n.checkEndOfBlock()&&(T=n.startPath(),I=T.block);)I.is("li")&&(R=I.getParent(),I.equals(R.getLast(m))&&I.equals(R.getFirst(m))&&(I=R)),n.moveToPosition(I,CKEDITOR.POSITION_BEFORE_START),I.remove();var v=n.clone(),f=e.editable();v.setEndAt(f,CKEDITOR.POSITION_BEFORE_END);var N=new CKEDITOR.dom.walker(v);N.evaluator=function(e){return m(e)&&!O(e)};var h=N.next();h&&h.type==CKEDITOR.NODE_ELEMENT&&h.getName()in CKEDITOR.dtd.$list&&s(h),t.moveToBookmark(a),t.select(),e.fire("saveSnapshot")}function c(e){var t=e.getLast(m);return t&&t.type==CKEDITOR.NODE_ELEMENT&&t.getName()in T?t:null}var T={ol:1,ul:1},u=CKEDITOR.dom.walker.whitespaces(),g=CKEDITOR.dom.walker.bookmark(),m=function(e){return!(u(e)||g(e))},O=CKEDITOR.dom.walker.bogus();CKEDITOR.plugins.list={listToArray:function(e,t,n,r,o){if(!T[e.getName()])return[];r||(r=0),n||(n=[]);for(var a=0,i=e.getChildCount();a<i;a++){var l=e.getChild(a);if(l.type==CKEDITOR.NODE_ELEMENT&&l.getName()in CKEDITOR.dtd.$list&&CKEDITOR.plugins.list.listToArray(l,t,n,r+1),"li"==l.$.nodeName.toLowerCase()){var s={parent:e,indent:r,element:l,contents:[]};o?s.grandparent=o:(s.grandparent=e.getParent(),s.grandparent&&"li"==s.grandparent.$.nodeName.toLowerCase()&&(s.grandparent=s.grandparent.getParent())),t&&CKEDITOR.dom.element.setMarker(t,l,"listarray_index",n.length),n.push(s);for(var E,d=0,c=l.getChildCount();d<c;d++)(E=l.getChild(d)).type==CKEDITOR.NODE_ELEMENT&&T[E.getName()]?CKEDITOR.plugins.list.listToArray(E,t,n,r+1,s.grandparent):s.contents.push(E)}}return n},arrayToList:function(n,r,o,a,i){if(o||(o=0),!n||n.length<o+1)return null;for(var l,s,E,d=n[o].parent.getDocument(),c=new CKEDITOR.dom.documentFragment(d),u=null,O=o,p=Math.max(n[o].indent,0),D=null,C=a==CKEDITOR.ENTER_P?"p":"div";;){var I=n[O],R=I.grandparent;if(s=I.element.getDirection(1),I.indent==p){for(u&&n[O].parent.getName()==u.getName()||(u=n[O].parent.clone(!1,1),i&&u.setAttribute("dir",i),c.append(u)),D=u.append(I.element.clone(0,1)),s!=u.getDirection(1)&&D.setAttribute("dir",s),l=0;l<I.contents.length;l++)D.append(I.contents[l].clone(1,1));O++}else if(I.indent==Math.max(p,0)+1){var v=n[O-1].element.getDirection(1),f=CKEDITOR.plugins.list.arrayToList(n,null,O,a,v!=s?s:null);!D.getChildCount()&&CKEDITOR.env.needsNbspFiller&&d.$.documentMode<=7&&D.append(d.createText(" ")),D.append(f.listNode),O=f.nextIndex}else{if(-1!=I.indent||o||!R)return null;T[R.getName()]?(D=I.element.clone(!1,!0),s!=R.getDirection(1)&&D.setAttribute("dir",s)):D=new CKEDITOR.dom.documentFragment(d);var N,h,K=R.getDirection(1)!=s,_=I.element,b=_.getAttribute("class"),k=_.getAttribute("style"),y=D.type==CKEDITOR.NODE_DOCUMENT_FRAGMENT&&(a!=CKEDITOR.ENTER_BR||K||k||b),A=I.contents.length;for(l=0;l<A;l++)N=I.contents[l],g(N)&&A>1?y?h=N.clone(1,1):D.append(N.clone(1,1)):N.type==CKEDITOR.NODE_ELEMENT&&N.isBlockBoundary()?(K&&!N.getDirection()&&N.setAttribute("dir",s),t(_,N),b&&N.addClass(b),E=null,h&&(D.append(h),h=null),D.append(N.clone(1,1))):y?(E||(E=d.createElement(C),D.append(E),K&&E.setAttribute("dir",s)),k&&E.setAttribute("style",k),b&&E.setAttribute("class",b),h&&(E.append(h),h=null),E.append(N.clone(1,1))):D.append(N.clone(1,1));if(h&&((E||D).append(h),h=null),D.type==CKEDITOR.NODE_DOCUMENT_FRAGMENT&&O!=n.length-1){var S;CKEDITOR.env.needsBrFiller&&(S=D.getLast())&&S.type==CKEDITOR.NODE_ELEMENT&&S.is("br")&&S.remove(),(S=D.getLast(m))&&S.type==CKEDITOR.NODE_ELEMENT&&S.is(CKEDITOR.dtd.$block)||D.append(d.createElement("br"))}var P=D.$.nodeName.toLowerCase();"div"!=P&&"p"!=P||D.appendBogus(),c.append(D),u=null,O++}if(E=null,n.length<=O||Math.max(n[O].indent,0)<p)break}if(r)for(var B=c.getFirst();B;)B.type==CKEDITOR.NODE_ELEMENT&&(CKEDITOR.dom.element.clearMarkers(r,B),B.getName()in CKEDITOR.dtd.$listItem&&e(B)),B=B.getNextSourceNode();return{listNode:c,nextIndex:O}}};var p=/^h[1-6]$/,D=CKEDITOR.dom.walker.nodeType(CKEDITOR.NODE_ELEMENT);i.prototype={exec:function(e){this.refresh(e,e.elementPath());var t=e.config,a=e.getSelection(),i=a&&a.getRanges();if(this.state==CKEDITOR.TRISTATE_OFF){var l=e.editable();if(l.getFirst(m)){var E=1==i.length&&i[0],d=E&&E.getEnclosedNode();d&&d.is&&this.type==d.getName()&&this.setState(CKEDITOR.TRISTATE_ON)}else t.enterMode==CKEDITOR.ENTER_BR?l.appendBogus():i[0].fixBlock(1,t.enterMode==CKEDITOR.ENTER_P?"p":"div"),a.selectRanges(i)}for(var c=a.createBookmarks(!0),u=[],g={},O=i.createIterator(),p=0;(E=O.getNextRange())&&++p;){var D=E.getBoundaryNodes(),C=D.startNode,I=D.endNode;C.type==CKEDITOR.NODE_ELEMENT&&"td"==C.getName()&&E.setStartAt(D.startNode,CKEDITOR.POSITION_AFTER_START),I.type==CKEDITOR.NODE_ELEMENT&&"td"==I.getName()&&E.setEndAt(D.endNode,CKEDITOR.POSITION_BEFORE_END);var R,v=E.createIterator();for(v.forceBrBreak=this.state==CKEDITOR.TRISTATE_OFF;R=v.getNextParagraph();)if(!R.getCustomData("list_block")){CKEDITOR.dom.element.setMarker(g,R,"list_block",1);for(var f,N=e.elementPath(R),h=N.elements,K=h.length,_=0,b=N.blockLimit,k=K-1;k>=0&&(f=h[k]);k--)if(T[f.getName()]&&b.contains(f)){b.removeCustomData("list_group_object_"+p);var y=f.getCustomData("list_group_object");y?y.contents.push(R):(y={root:f,contents:[R]},u.push(y),CKEDITOR.dom.element.setMarker(g,f,"list_group_object",y)),_=1;break}if(!_){var A=b;A.getCustomData("list_group_object_"+p)?A.getCustomData("list_group_object_"+p).contents.push(R):(y={root:A,contents:[R]},CKEDITOR.dom.element.setMarker(g,A,"list_group_object_"+p,y),u.push(y))}}}for(var S=[];u.length>0;)y=u.shift(),this.state==CKEDITOR.TRISTATE_OFF?T[y.root.getName()]?n.call(this,e,y,g,S):r.call(this,e,y,S):this.state==CKEDITOR.TRISTATE_ON&&T[y.root.getName()]&&o.call(this,e,y,g);for(k=0;k<S.length;k++)s(S[k]);CKEDITOR.dom.element.clearAllMarkers(g),a.selectBookmarks(c),e.focus()},refresh:function(e,t){var n=t.contains(T,1),r=t.blockLimit||t.root;n&&r.contains(n)?this.setState(n.is(this.type)?CKEDITOR.TRISTATE_ON:CKEDITOR.TRISTATE_OFF):this.setState(CKEDITOR.TRISTATE_OFF)}},CKEDITOR.plugins.add("list",{lang:"af,ar,az,bg,bn,bs,ca,cs,cy,da,de,de-ch,el,en,en-au,en-ca,en-gb,eo,es,es-mx,et,eu,fa,fi,fo,fr,fr-ca,gl,gu,he,hi,hr,hu,id,is,it,ja,ka,km,ko,ku,lt,lv,mk,mn,ms,nb,nl,no,oc,pl,pt,pt-br,ro,ru,si,sk,sl,sq,sr,sr-latn,sv,th,tr,tt,ug,uk,vi,zh,zh-cn",icons:"bulletedlist,bulletedlist-rtl,numberedlist,numberedlist-rtl",hidpi:!0,requires:"indentlist",init:function(e){e.blockless||(e.addCommand("numberedlist",new i("numberedlist","ol")),e.addCommand("bulletedlist",new i("bulletedlist","ul")),e.ui.addButton&&(e.ui.addButton("NumberedList",{label:e.lang.list.numberedlist,command:"numberedlist",directional:!0,toolbar:"list,10"}),e.ui.addButton("BulletedList",{label:e.lang.list.bulletedlist,command:"bulletedlist",directional:!0,toolbar:"list,20"})),e.on("key",function(t){var n,r=t.data.domEvent.getKey();if("wysiwyg"==e.mode&&r in{8:1,46:1}){var o=e.getSelection().getRanges()[0],a=o&&o.startPath();if(!o||!o.collapsed)return;var i=8==r,l=e.editable(),s=new CKEDITOR.dom.walker(o.clone());s.evaluator=function(e){return m(e)&&!O(e)},s.guard=function(e,t){return!(t&&e.type==CKEDITOR.NODE_ELEMENT&&e.is("table"))};var u=o.clone();if(i){var g,p;if((g=a.contains(T))&&o.checkBoundaryOfElement(g,CKEDITOR.START)&&(g=g.getParent())&&g.is("li")&&(g=c(g))?(p=g,g=g.getPrevious(m),u.moveToPosition(g&&O(g)?g:p,CKEDITOR.POSITION_BEFORE_START)):(s.range.setStartAt(l,CKEDITOR.POSITION_AFTER_START),s.range.setEnd(o.startContainer,o.startOffset),(g=s.previous())&&g.type==CKEDITOR.NODE_ELEMENT&&(g.getName()in T||g.is("li"))&&(g.is("li")||(s.range.selectNodeContents(g),s.reset(),s.evaluator=E,g=s.previous()),p=g,u.moveToElementEditEnd(p),u.moveToPosition(u.endPath().block,CKEDITOR.POSITION_BEFORE_END))),p)d(e,u,o),t.cancel();else{var D=a.contains(T);D&&o.checkBoundaryOfElement(D,CKEDITOR.START)&&(n=D.getFirst(m),o.checkBoundaryOfElement(n,CKEDITOR.START)&&(g=D.getPrevious(m),c(n)?(g&&(o.moveToElementEditEnd(g),o.select()),t.cancel()):(e.execCommand("outdent"),t.cancel())))}}else{var C,I;if(n=a.contains("li")){s.range.setEndAt(l,CKEDITOR.POSITION_BEFORE_END);var R=n.getLast(m),v=R&&E(R)?R:n,f=0;if(C=s.next(),C&&C.type==CKEDITOR.NODE_ELEMENT&&C.getName()in T&&C.equals(R)?(f=1,C=s.next()):o.checkBoundaryOfElement(v,CKEDITOR.END)&&(f=2),f&&C){if((I=o.clone()).moveToElementEditStart(C),1==f&&(u.optimize(),!u.startContainer.equals(n))){for(var N,h=u.startContainer;h.is(CKEDITOR.dtd.$inline);)N=h,h=h.getParent();N&&u.moveToPosition(N,CKEDITOR.POSITION_AFTER_END)}2==f&&(u.moveToPosition(u.endPath().block,CKEDITOR.POSITION_BEFORE_END),I.endPath().block&&I.moveToPosition(I.endPath().block,CKEDITOR.POSITION_AFTER_START)),d(e,u,I),t.cancel()}}else s.range.setEndAt(l,CKEDITOR.POSITION_BEFORE_END),(C=s.next())&&C.type==CKEDITOR.NODE_ELEMENT&&C.is(T)&&(C=C.getFirst(m),a.block&&o.checkStartOfBlock()&&o.checkEndOfBlock()?(a.block.remove(),o.moveToElementEditStart(C),o.select(),t.cancel()):c(C)?(o.moveToElementEditStart(C),o.select(),t.cancel()):((I=o.clone()).moveToElementEditStart(C),d(e,u,I),t.cancel()))}setTimeout(function(){e.selectionChange(1)})}}))}})}();