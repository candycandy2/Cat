!function(){"use strict";function e(e,t,s,r,n){var i,l,a=[];for(i in t)l="boolean"==typeof(l=t[i])?{}:"function"==typeof l?{match:l}:X(l),"$"!=i.charAt(0)&&(l.elements=i),s&&(l.featureName=s.toLowerCase()),w(l),r.push(l),a.push(l);E(n,a)}function t(e,t,n,i){e.match&&!e.match(t)||(i||d(e,t))&&(e.propertiesOnly||(n.valid=!0),n.allAttributes||(n.allAttributes=r(e.attributes,t.attributes,n.validAttributes)),n.allStyles||(n.allStyles=r(e.styles,t.styles,n.validStyles)),n.allClasses||(n.allClasses=s(e.classes,t.classes,n.validClasses)))}function s(e,t,s){if(!e)return!1;if(!0===e)return!0;for(var r,n=0,i=t.length;n<i;++n)s[r=t[n]]||(s[r]=e(r));return!1}function r(e,t,s){if(!e)return!1;if(!0===e)return!0;for(var r in t)s[r]||(s[r]=e(r));return!1}function n(e,t,s){if(!e.match||e.match(t)){if(e.noProperties)return!1;s.hadInvalidAttribute=l(e.attributes,t.attributes)||s.hadInvalidAttribute,s.hadInvalidStyle=l(e.styles,t.styles)||s.hadInvalidStyle,s.hadInvalidClass=i(e.classes,t.classes)||s.hadInvalidClass}}function i(e,t){if(!e)return!1;for(var s=!1,r=!0===e,n=t.length;n--;)(r||e(t[n]))&&(t.splice(n,1),s=!0);return s}function l(e,t){if(!e)return!1;var s=!1,r=!0===e;for(var n in t)(r||e(n))&&(delete t[n],s=!0);return s}function a(e,t,s){return!e.disabled&&(!(e.customConfig&&!s)&&(!!t&&(e._.cachedChecks={},!0)))}function o(e){var t,s=e.getDefinition(),r={},n=s.attributes;return r[s.element]=t={styles:s.styles,requiredStyles:s.styles&&CKEDITOR.tools.objectKeys(s.styles)},n&&(n=X(n),t.classes=n.class?n.class.split(/\s+/):null,t.requiredClasses=t.classes,delete n.class,t.attributes=n,t.requiredAttributes=n&&CKEDITOR.tools.objectKeys(n)),r}function u(e,t){if(!e)return!1;if(!0===e)return e;if("string"==typeof e)return"*"==(e=J(e))||CKEDITOR.tools.convertArrayToObject(e.split(t));if(CKEDITOR.tools.isArray(e))return!!e.length&&CKEDITOR.tools.convertArrayToObject(e);var s={},r=0;for(var n in e)s[n]=e[n],r++;return!!r&&s}function c(e,t){for(var s,r=0,n=t.length;r<n;++r)if(s=t[r](e))return s}function f(e,t){var s,r=[],n=!0;e?n=!1:e={};for(s in t)"!"==s.charAt(0)&&(s=s.slice(1),r.push(s),e[s]=!0,n=!1);for(;s=r.pop();)t[s]=t["!"+s],delete t["!"+s];return!n&&e}function h(e,s,r){var i,l,a=s.name,o=e._,u=o.allowedRules.elements[a],c=o.allowedRules.generic,f=o.disallowedRules.elements[a],h=o.disallowedRules.generic,d=r.skipRequired,y={valid:!1,validAttributes:{},validClasses:{},validStyles:{},allAttributes:!1,allClasses:!1,allStyles:!1,hadInvalidAttribute:!1,hadInvalidClass:!1,hadInvalidStyle:!1};if(!u&&!c)return null;if(R(s),f)for(i=0,l=f.length;i<l;++i)if(!1===n(f[i],s,y))return null;if(h)for(i=0,l=h.length;i<l;++i)n(h[i],s,y);if(u)for(i=0,l=u.length;i<l;++i)t(u[i],s,y,d);if(c)for(i=0,l=c.length;i<l;++i)t(c[i],s,y,d);return y}function d(e,t){if(e.nothingRequired)return!0;var s,r,n,i;if(n=e.requiredClasses)for(i=t.classes,s=0;s<n.length;++s)if("string"==typeof(r=n[s])){if(-1==CKEDITOR.tools.indexOf(i,r))return!1}else if(!CKEDITOR.tools.checkIfAnyArrayItemMatches(i,r))return!1;return y(t.styles,e.requiredStyles)&&y(t.attributes,e.requiredAttributes)}function y(e,t){if(!t)return!0;for(var s,r=0;r<t.length;++r)if("string"==typeof(s=t[r])){if(!(s in e))return!1}else if(!CKEDITOR.tools.checkIfAnyObjectPropertyMatches(e,s))return!1;return!0}function p(e){var t=T(e).$1,s=t.styles,r=t.classes;return t.name=t.elements,t.classes=r=r?r.split(/\s*,\s*/):[],t.styles=b(s),t.attributes=b(t.attributes),t.children=[],r.length&&(t.attributes.class=r.join(" ")),s&&(t.attributes.style=CKEDITOR.tools.writeCssText(t.styles)),t}function m(e){var t=e.getDefinition(),s=t.styles,r=t.attributes||{};return s&&!CKEDITOR.tools.isEmpty(s)?(s=X(s),r.style=CKEDITOR.tools.writeCssText(s,!0)):s={},{name:t.element,attributes:r,classes:r.class?r.class.split(/\s+/):[],styles:s,children:[]}}function b(e){if(!e)return{};for(var t=e.split(/\s*,\s*/).sort(),s={};t.length;)s[t.shift()]=Q;return s}function C(e){var t=[];for(var s in e)s.indexOf("*")>-1?t.push(new RegExp("^"+s.replace(/\*/g,".*")+"$")):t.push(s);return t}function g(e){var t,s,r;for(t in ee)e[t]=N(e[t]);var n=!0;for(r in te)(s=C(e[t=te[r]])).length&&(e[t]=s,n=!1);e.nothingRequired=n,e.noProperties=!(e.attributes||e.classes||e.styles)}function E(e,t){var s,r,n,i,l,a=e.elements,o=e.generic;for(s=0,r=t.length;s<r;++s)if(n=X(t[s]),l=!0===n.classes||!0===n.styles||!0===n.attributes,g(n),!0===n.elements||null===n.elements)o[l?"unshift":"push"](n);else{var u=n.elements;delete n.elements;for(i in u)a[i]?a[i][l?"unshift":"push"](n):a[i]=[n]}}function T(e){var t,s,r,n,i,l={},a=1;for(e=J(e);t=e.match(se);)(s=t[2])?(r=v(s,"styles"),n=v(s,"attrs"),i=v(s,"classes")):r=n=i=null,l["$"+a++]={elements:t[1],classes:i,styles:r,attributes:n},e=e.slice(t[0].length);return l}function v(e,t){var s=e.match(re[t]);return s?J(s[1]):null}function R(e){var t=e.styleBackup=e.attributes.style,s=e.classBackup=e.attributes.class;e.styles||(e.styles=CKEDITOR.tools.parseCssText(t||"",1)),e.classes||(e.classes=s?s.split(/\s+/):[])}function O(e,t,s,r){var n,i,l,a,o=decodeURIComponent(t.value.replace(/^\{cke_protected\}/,"")),u=[];if(s)for(l=0;l<s.length;++l)if((a=o.match(s[l]))&&a[0].length==o.length)return!0;return 1==(n=CKEDITOR.htmlParser.fragment.fromHtml(o)).children.length&&(i=n.children[0]).type==CKEDITOR.NODE_ELEMENT&&D(e,i,u,r),!u.length}function D(e,t,s,r){var n,i,l=0;if(r.toHtml&&(t.name=t.name.replace(ne,"$1")),r.doCallbacks&&e.elementCallbacks&&(i=c(t,e.elementCallbacks)))return i;if(r.doTransform&&k(e,t),r.doFilter){if(!(n=h(e,t,r)))return s.push(t),W;if(!n.valid)return s.push(t),W;if(_(t,n)&&(l=W),!r.skipFinalValidation&&!A(t))return s.push(t),W}return r.toHtml&&(t.name=t.name.replace(ie,"cke:$1")),l}function I(e){var t,s=[];for(t in e)t.indexOf("*")>-1&&s.push(t.replace(/\*/g,".*"));return s.length?new RegExp("^(?:"+s.join("|")+")$"):null}function w(e){e.elements=u(e.elements,/\s+/)||null,e.propertiesOnly=e.propertiesOnly||!0===e.elements;var t,s=/\s*,\s*/;for(t in ee)e[t]=u(e[t],s)||null,e[te[t]]=f(u(e[te[t]],s),e[t])||null;e.match=e.match||null}function k(e,t){var s,r=e._.transformations[t.name];if(r){for(R(t),s=0;s<r.length;++s)B(e,t,r[s]);K(t)}}function K(e){var t,s=e.attributes;delete s.style,delete s.class,(t=CKEDITOR.tools.writeCssText(e.styles,!0))&&(s.style=t),e.classes.length&&(s.class=e.classes.sort().join(" "))}function _(e,t){var s,r,n,i=t.validAttributes,l=t.validStyles,a=t.validClasses,o=e.attributes,u=e.styles,c=e.classes,f=e.classBackup,h=e.styleBackup,d=[],y=[],p=/^data-cke-/,m=!1;if(delete o.style,delete o.class,delete e.classBackup,delete e.styleBackup,!t.allAttributes)for(s in o)i[s]||(p.test(s)?s==(r=s.replace(/^data-cke-saved-/,""))||i[r]||(delete o[s],m=!0):(delete o[s],m=!0));if(!t.allStyles||t.hadInvalidStyle){for(s in u)t.allStyles||l[s]?d.push(s+":"+u[s]):m=!0;d.length&&(o.style=d.sort().join("; "))}else h&&(o.style=h);if(!t.allClasses||t.hadInvalidClass){for(n=0;n<c.length;++n)(t.allClasses||a[c[n]])&&y.push(c[n]);y.length&&(o.class=y.sort().join(" ")),f&&y.length<f.split(/\s+/).length&&(m=!0)}else f&&(o.class=f);return m}function A(e){switch(e.name){case"a":if(!(e.children.length||e.attributes.name||e.attributes.id))return!1;break;case"img":if(!e.attributes.src)return!1}return!0}function N(e){if(!e)return!1;if(!0===e)return!0;var t=I(e);return function(s){return s in e||t&&s.match(t)}}function S(e,t){for(var s,r=V[t],n=0,i=e.length;n<i;++n)if((s=e[n]).type==CKEDITOR.NODE_ELEMENT&&!r[s.name])return!1;return!0}function M(){return new CKEDITOR.htmlParser.element("br")}function x(e){return e.type==CKEDITOR.NODE_TEXT||e.type==CKEDITOR.NODE_ELEMENT&&V.$inline[e.name]}function F(e){return e.type==CKEDITOR.NODE_ELEMENT&&("br"==e.name||V.$block[e.name])}function j(e,t,s){var r=e.name;V.$empty[r]||!e.children.length?"hr"==r&&"br"==t?e.replaceWith(M()):(e.parent&&s.push({check:"it",el:e.parent}),e.remove()):V.$block[r]||"tr"==r?"br"==t?$(e):q(e,t,s):r in{style:1,script:1}?e.remove():(e.parent&&s.push({check:"it",el:e.parent}),e.replaceWithChildren())}function q(e,t,s){var r=e.children;if(S(r,t))return e.name=t,e.attributes={},void s.push({check:"parent-down",el:e});var n,i,l,a,o=e.parent,u=o.type==CKEDITOR.NODE_DOCUMENT_FRAGMENT||"body"==o.name;for(n=r.length;n>0;)i=r[--n],u&&x(i)?(l||((l=new CKEDITOR.htmlParser.element(t)).insertAfter(e),s.push({check:"parent-down",el:l})),l.add(i,0)):(l=null,a=V[o.name]||V.span,i.insertAfter(e),o.type==CKEDITOR.NODE_DOCUMENT_FRAGMENT||i.type!=CKEDITOR.NODE_ELEMENT||a[i.name]||s.push({check:"el-up",el:i}));e.remove()}function $(e){e.previous&&!F(e.previous)&&M().insertBefore(e),e.next&&!F(e.next)&&M().insertAfter(e),e.replaceWithChildren()}function B(e,t,s){var r,n;for(r=0;r<s.length;++r)if((!(n=s[r]).check||e.check(n.check,!1))&&(!n.left||n.left(t)))return void n.right(t,Z)}function L(e,t){var s,r,n,i,l,a=t.getDefinition(),o=a.attributes,u=a.styles;if(e.name!=a.element)return!1;for(s in o)if("class"==s){for(n=o[s].split(/\s+/),i=e.classes.join("|");l=n.pop();)if(-1==i.indexOf(l))return!1}else if(e.attributes[s]!=o[s])return!1;for(r in u)if(e.styles[r]!=u[r])return!1;return!0}function P(e,t){var s,r;return"string"==typeof e?s=e:e instanceof CKEDITOR.style?r=e:(s=e[0],r=e[1]),[{element:s,left:r,right:function(e,s){s.transform(e,t)}}]}function U(e,t){return e.element?e.element:t?t.match(/^([a-z0-9]+)/i)[0]:e.left.getDefinition().element}function z(e){return function(t){return L(t,e)}}function G(e){return function(t,s){s[e](t)}}function H(e){var t,s,r,n,i,l,a=[];for(s=0;s<e.length;++s)"string"==typeof(r=e[s])?(n=(r=r.split(/\s*:\s*/))[0],i=null,l=r[1]):(n=r.check,i=r.left,l=r.right),t||(t=U(r,n)),i instanceof CKEDITOR.style&&(i=z(i)),a.push({check:n==t?null:n,left:i,right:"string"==typeof l?G(l):l});return{name:t,rules:a}}var V=CKEDITOR.dtd,W=1,X=CKEDITOR.tools.copy,J=CKEDITOR.tools.trim,Q="cke-test",Y=["","p","br","div"];CKEDITOR.FILTER_SKIP_TREE=2,CKEDITOR.filter=function(e){if(this.allowedContent=[],this.disallowedContent=[],this.elementCallbacks=null,this.disabled=!1,this.editor=null,this.id=CKEDITOR.tools.getNextNumber(),this._={allowedRules:{elements:{},generic:[]},disallowedRules:{elements:{},generic:[]},transformations:{},cachedTests:{},cachedChecks:{}},CKEDITOR.filter.instances[this.id]=this,e instanceof CKEDITOR.editor){var t=this.editor=e;this.customConfig=!0;var s=t.config.allowedContent;if(!0===s)return void(this.disabled=!0);s||(this.customConfig=!1),this.allow(s,"config",1),this.allow(t.config.extraAllowedContent,"extra",1),this.allow(Y[t.enterMode]+" "+Y[t.shiftEnterMode],"default",1),this.disallow(t.config.disallowedContent)}else this.customConfig=!1,this.allow(e,"default",1)},CKEDITOR.filter.instances={},CKEDITOR.filter.prototype={allow:function(t,s,r){if(!a(this,t,r))return!1;var n,i;if("string"==typeof t)t=T(t);else if(t instanceof CKEDITOR.style){if(t.toAllowedContentRules)return this.allow(t.toAllowedContentRules(this.editor),s,r);t=o(t)}else if(CKEDITOR.tools.isArray(t)){for(n=0;n<t.length;++n)i=this.allow(t[n],s,r);return i}return e(this,t,s,this.allowedContent,this._.allowedRules),!0},applyTo:function(e,t,s,r){if(this.disabled)return!1;var n,i=this,l=[],a=this.editor&&this.editor.config.protectedSource,o=!1,u={doFilter:!s,doTransform:!0,doCallbacks:!0,toHtml:t};e.forEach(function(e){if(e.type==CKEDITOR.NODE_ELEMENT){if("off"==e.attributes["data-cke-filter"])return!1;if(t&&"span"==e.name&&~CKEDITOR.tools.objectKeys(e.attributes).join("|").indexOf("data-cke-"))return;if((n=D(i,e,l,u))&W)o=!0;else if(2&n)return!1}else e.type==CKEDITOR.NODE_COMMENT&&e.value.match(/^\{cke_protected\}(?!\{C\})/)&&(O(i,e,a,u)||l.push(e))},null,!0),l.length&&(o=!0);for(var c,f,h,d,y=[],p=Y[r||(this.editor?this.editor.enterMode:CKEDITOR.ENTER_P)];c=l.pop();)c.type==CKEDITOR.NODE_ELEMENT?j(c,p,y):c.remove();for(;h=y.pop();)if((f=h.el).parent)switch(d=V[f.parent.name]||V.span,h.check){case"it":V.$removeEmpty[f.name]&&!f.children.length?j(f,p,y):A(f)||j(f,p,y);break;case"el-up":f.parent.type==CKEDITOR.NODE_DOCUMENT_FRAGMENT||d[f.name]||j(f,p,y);break;case"parent-down":f.parent.type==CKEDITOR.NODE_DOCUMENT_FRAGMENT||d[f.name]||j(f.parent,p,y)}return o},checkFeature:function(e){return!!this.disabled||(!e||(e.toFeature&&(e=e.toFeature(this.editor)),!e.requiredContent||this.check(e.requiredContent)))},disable:function(){this.disabled=!0},disallow:function(t){return!!a(this,t,!0)&&("string"==typeof t&&(t=T(t)),e(this,t,null,this.disallowedContent,this._.disallowedRules),!0)},addContentForms:function(e){if(!this.disabled&&e){var t,s,r,n=[];for(t=0;t<e.length&&!r;++t)("string"==typeof(s=e[t])||s instanceof CKEDITOR.style)&&this.check(s)&&(r=s);if(r){for(t=0;t<e.length;++t)n.push(P(e[t],r));this.addTransformations(n)}}},addElementCallback:function(e){this.elementCallbacks||(this.elementCallbacks=[]),this.elementCallbacks.push(e)},addFeature:function(e){return!!this.disabled||(!e||(e.toFeature&&(e=e.toFeature(this.editor)),this.allow(e.allowedContent,e.name),this.addTransformations(e.contentTransformations),this.addContentForms(e.contentForms),!e.requiredContent||!this.customConfig&&!this.disallowedContent.length||this.check(e.requiredContent)))},addTransformations:function(e){if(!this.disabled&&e){var t,s,r=this._.transformations;for(s=0;s<e.length;++s)r[(t=H(e[s])).name]||(r[t.name]=[]),r[t.name].push(t.rules)}},check:function(e,t,s){if(this.disabled)return!0;if(CKEDITOR.tools.isArray(e)){for(var r=e.length;r--;)if(this.check(e[r],t,s))return!0;return!1}var n,i,l;if("string"==typeof e){if((l=e+"<"+(!1===t?"0":"1")+(s?"1":"0")+">")in this._.cachedChecks)return this._.cachedChecks[l];n=p(e)}else n=m(e);var a,o=CKEDITOR.tools.clone(n),u=[];if(!1!==t&&(a=this._.transformations[n.name])){for(r=0;r<a.length;++r)B(this,n,a[r]);K(n)}return D(this,o,u,{doFilter:!0,doTransform:!1!==t,skipRequired:!s,skipFinalValidation:!s}),i=!(u.length>0)&&!!CKEDITOR.tools.objectCompare(n.attributes,o.attributes,!0),"string"==typeof e&&(this._.cachedChecks[l]=i),i},getAllowedEnterMode:function(){var e=["p","div","br"],t={p:CKEDITOR.ENTER_P,div:CKEDITOR.ENTER_DIV,br:CKEDITOR.ENTER_BR};return function(s,r){var n,i=e.slice();if(this.check(Y[s]))return s;for(r||(i=i.reverse());n=i.pop();)if(this.check(n))return t[n];return CKEDITOR.ENTER_BR}}(),clone:function(){var e=new CKEDITOR.filter,t=CKEDITOR.tools.clone;return e.allowedContent=t(this.allowedContent),e._.allowedRules=t(this._.allowedRules),e.disallowedContent=t(this.disallowedContent),e._.disallowedRules=t(this._.disallowedRules),e._.transformations=t(this._.transformations),e.disabled=this.disabled,e.editor=this.editor,e},destroy:function(){delete CKEDITOR.filter.instances[this.id],delete this._,delete this.allowedContent,delete this.disallowedContent}};var Z,ee={styles:1,attributes:1,classes:1},te={styles:"requiredStyles",attributes:"requiredAttributes",classes:"requiredClasses"},se=/^([a-z0-9\-*\s]+)((?:\s*\{[!\w\-,\s\*]+\}\s*|\s*\[[!\w\-,\s\*]+\]\s*|\s*\([!\w\-,\s\*]+\)\s*){0,3})(?:;\s*|$)/i,re={styles:/{([^}]+)}/,attrs:/\[([^\]]+)\]/,classes:/\(([^\)]+)\)/},ne=/^cke:(object|embed|param)$/,ie=/^(object|embed|param)$/;Z=CKEDITOR.filter.transformationsTools={sizeToStyle:function(e){this.lengthToStyle(e,"width"),this.lengthToStyle(e,"height")},sizeToAttribute:function(e){this.lengthToAttribute(e,"width"),this.lengthToAttribute(e,"height")},lengthToStyle:function(e,t,s){if(!((s=s||t)in e.styles)){var r=e.attributes[t];r&&(/^\d+$/.test(r)&&(r+="px"),e.styles[s]=r)}delete e.attributes[t]},lengthToAttribute:function(e,t,s){if(!((s=s||t)in e.attributes)){var r=e.styles[t],n=r&&r.match(/^(\d+)(?:\.\d*)?px$/);n?e.attributes[s]=n[1]:r==Q&&(e.attributes[s]=Q)}delete e.styles[t]},alignmentToStyle:function(e){if(!("float"in e.styles)){var t=e.attributes.align;"left"!=t&&"right"!=t||(e.styles.float=t)}delete e.attributes.align},alignmentToAttribute:function(e){if(!("align"in e.attributes)){var t=e.styles.float;"left"!=t&&"right"!=t||(e.attributes.align=t)}delete e.styles.float},splitBorderShorthand:function(e){function t(t){e.styles["border-top-width"]=s[t[0]],e.styles["border-right-width"]=s[t[1]],e.styles["border-bottom-width"]=s[t[2]],e.styles["border-left-width"]=s[t[3]]}if(e.styles.border){var s=e.styles.border.match(/([\.\d]+\w+)/g)||["0px"];switch(s.length){case 1:e.styles["border-width"]=s[0];break;case 2:t([0,1,0,1]);break;case 3:t([0,1,2,1]);break;case 4:t([0,1,2,3])}e.styles["border-style"]=e.styles["border-style"]||(e.styles.border.match(/(none|hidden|dotted|dashed|solid|double|groove|ridge|inset|outset|initial|inherit)/)||[])[0],e.styles["border-style"]||delete e.styles["border-style"],delete e.styles.border}},listTypeToStyle:function(e){if(e.attributes.type)switch(e.attributes.type){case"a":e.styles["list-style-type"]="lower-alpha";break;case"A":e.styles["list-style-type"]="upper-alpha";break;case"i":e.styles["list-style-type"]="lower-roman";break;case"I":e.styles["list-style-type"]="upper-roman";break;case"1":e.styles["list-style-type"]="decimal";break;default:e.styles["list-style-type"]=e.attributes.type}},splitMarginShorthand:function(e){function t(t){e.styles["margin-top"]=s[t[0]],e.styles["margin-right"]=s[t[1]],e.styles["margin-bottom"]=s[t[2]],e.styles["margin-left"]=s[t[3]]}if(e.styles.margin){var s=e.styles.margin.match(/(\-?[\.\d]+\w+)/g)||["0px"];switch(s.length){case 1:t([0,0,0,0]);break;case 2:t([0,1,0,1]);break;case 3:t([0,1,2,1]);break;case 4:t([0,1,2,3])}delete e.styles.margin}},matchesStyle:L,transform:function(e,t){if("string"==typeof t)e.name=t;else{var s,r,n,i,l,a=t.getDefinition(),o=a.styles,u=a.attributes;e.name=a.element;for(s in u)if("class"==s)for(n=e.classes.join("|"),i=u[s].split(/\s+/);l=i.pop();)-1==n.indexOf(l)&&e.classes.push(l);else e.attributes[s]=u[s];for(r in o)e.styles[r]=o[r]}}}}();